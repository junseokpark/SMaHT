#!/usr/bin/env Rscript
if (suppressMessages(!require("UpSetR"))) suppressMessages(install.packages("UpSetR", repos="http://cran.us.r-project.org"))
library("UpSetR")
pdf("/n/data1/bch/genetics/lee/projects/SMaHT/scripts/COLO829-Analysis/L1/Intervene_results/Intervene_upset.pdf", width=14, height=8, onefile=FALSE, useDingbats=FALSE)
expressionInput <- c('xTea-mosaic-COLO829T_LINE1'=1,'xTea-mosaic-COLO829BL_LINE1'=1,'xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'RetroSom-COLO829T_LINE1'=1,'RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829T_LINE1'=1,'xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=55,'xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1'=1,'xTea-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1'=49,'xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=1,'xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=1,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=1,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=190,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1'=8344,'gnomAD_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&RetroSom-COLO829T_LINE1'=0,'gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=2,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1'=1516,'1KGP_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=2,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1'=1525,'1KGP_LINE1&gnomAD_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1'=2,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=3,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829T_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1'=0,'1KGP_LINE1&gnomAD_LINE1&xTea-COLO829BL_LINE1&xTea-COLO829T_LINE1&RetroSom-COLO829T_LINE1&xTea-mosaic-COLO829BL_LINE1&xTea-mosaic-COLO829T_LINE1'=0)
upset(fromExpression(expressionInput), nsets=7, nintersects=30, show.numbers="yes", main.bar.color="#ea5d4e", sets.bar.color="#317eab", empty.intersections=NULL, order.by = "freq", number.angles = 0, mainbar.y.label ="No. of Intersections", sets.x.label ="Set size")
invisible(dev.off())
